<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>수어영상 학습 사이트</title>
  <style>
    body { background:#0f172a; color:#e5e7eb; font-family: system-ui, sans-serif; margin:0; }
    header { background:#111827; padding:12px 16px; position:sticky; top:0; }
    h1 { margin:0; font-size:20px; }
    .wrap { max-width:800px; margin:0 auto; padding:16px; }
    video { width:100%; border-radius:12px; background:#000; }
    button { margin:4px; padding:8px 12px; border-radius:8px; cursor:pointer; border:none; font-size:14px; }
    .secondary { background:#1f2937; color:#e5e7eb; }
    .ghost { background:transparent; color:#e5e7eb; border:1px dashed #4b5563; }
    .answer { display:none; margin-top:10px; padding:8px; background:rgba(34,197,94,0.1); border-radius:8px; }
    .memo { margin-top:12px; }
    .memo textarea { width:100%; min-height:80px; border-radius:8px; padding:8px; background:#0b1220; color:#e5e7eb; border:1px solid #374151; }
    .controls { margin-top:8px; }
  </style>
</head>
<body>
  <header>
    <h1>수어영상 학습 사이트</h1>
  </header>
  <main class="wrap">
    <div id="card"></div>
    <div class="controls">
      <button id="prevBtn" class="secondary">⬅ 이전</button>
      <button id="nextBtn" class="secondary">다음 ➡</button>
      <button id="toggleAnswer" class="secondary">정답확인</button>
      <button id="slower" class="ghost">⏪ 느리게</button>
      <button id="faster" class="ghost">⏩ 빠르게</button>
    </div>
    <div class="answer" id="answer"></div>
    <div class="memo">
      <textarea id="memoBox" placeholder="메모를 입력하거나 음성으로 기록하세요..."></textarea>
      <div>
        <button id="voiceBtn" class="secondary">🎙️ 음성입력</button>
      </div>
    </div>
  </main>

  <script>
    const data = [
      { k:"종", ex:"나는 딸과 걷던 중에 딸이 종을 사달라고 졸라서 딸에게 종을 사 주었다.", src:"https://ksldict.korean.go.kr/kslserv/signFile/video/exmp/202410/LJnoOaDhWmp79ayX.mp4" },
      { k:"종", ex:"새해를 맞아 제야의 종소리가 울려 퍼졌다.", src:"https://ksldict.korean.go.kr/kslserv/signFile/video/exmp/202410/q7oplifUF3jxiflF.mp4" },
      { k:"언니, 누나", ex:"우리 언니는 잔소리 대마왕이다.", src:"https://ksldict.korean.go.kr/kslserv/signFile/video/exmp/202411/KAzk0Lpg8kVYKDIE.mp4" },
      { k:"언니, 누나", ex:"우리 언니랑 나랑 얼굴이 똑같다고? 그런 말은 처음 들어.", src:"https://ksldict.korean.go.kr/kslserv/signFile/video/exmp/202411/RPeMYLOXzDIFD77p.mp4" },
      { k:"언니, 누나", ex:"우리 언니는 항공사에서 일한다.", src:"https://ksldict.korean.go.kr/kslserv/signFile/video/exmp/202411/aPHbBWANGd2ROYhJ.mp4" },
      { k:"언니, 누나", ex:"나는 남동생은 있고 언니는 없다.", src:"https://ksldict.korean.go.kr/kslserv/signFile/video/exmp/202411/68EphdW6QNnndXSG.mp4" },
      { k:"아이고, 아뿔싸", ex:"나는 라면을 끓여서 먹다가 계란을 넣는 것을 깜박했다는 걸 깨달았다.", src:"https://ksldict.korean.go.kr/kslserv/signFile/video/exmp/202411/hHjAX8dOCpXMUKcG.mp4" },
      { k:"아이고, 아뿔싸", ex:"가: 오후에 비가 내린다는데, 우산 챙겼어? 나: 아이고. 깜빡했네.", src:"https://ksldict.korean.go.kr/kslserv/signFile/video/exmp/202411/a3mFRN8ardsnitaQ.mp4" },
      { k:"아이고, 아뿔싸", ex:"나는 비행기를 타고 나서야 핸드폰 충전기를 집에 두고 온 것이 생각났다.", src:"https://ksldict.korean.go.kr/kslserv/signFile/video/exmp/202411/CpIXrdKcNgjECYYN.mp4" },
      { k:"아이고, 아뿔싸", ex:"나는 축구 경기에서, 어렵게 골대 앞까지 가서 슛을 날렸는데 공이 골대를 빗겨 나가고 말았다.", src:"https://ksldict.korean.go.kr/kslserv/signFile/video/exmp/202411/4xPXgFiK9GgfH9Lb.mp4" }
    ];

    let idx = 0;
    const cardDiv = document.getElementById('card');
    const answerDiv = document.getElementById('answer');
    const memoBox = document.getElementById('memoBox');

    function render(){
      const item = data[idx];
      cardDiv.innerHTML = `
        <h3>한국어 대응표현: ${item.k}</h3>
        <video id="video" controls src="${item.src}"></video>
      `;
      answerDiv.style.display = 'none';
      answerDiv.textContent = item.ex;
      memoBox.value = localStorage.getItem(`memo::${item.src}`)||'';
    }

    render();

    document.getElementById('prevBtn').onclick = ()=>{ idx=(idx-1+data.length)%data.length; render(); };
    document.getElementById('nextBtn').onclick = ()=>{ idx=(idx+1)%data.length; render(); };
    document.getElementById('toggleAnswer').onclick = ()=>{
      answerDiv.style.display = (answerDiv.style.display==='block'?'none':'block');
    };

    document.getElementById('slower').onclick = ()=>{
      const v=document.getElementById('video');
      v.playbackRate=Math.max(0.25, v.playbackRate-0.25);
    };
    document.getElementById('faster').onclick = ()=>{
      const v=document.getElementById('video');
      v.playbackRate=Math.min(3, v.playbackRate+0.25);
    };

    memoBox.addEventListener('input', ()=>{
      const item = data[idx];
      localStorage.setItem(`memo::${item.src}`, memoBox.value);
    });

    // 음성 입력 -> 텍스트 변환
    const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
    let rec;
    if(SpeechRecognition){
      rec = new SpeechRecognition();
      rec.lang='ko-KR';
      rec.continuous=false;
      rec.interimResults=false;
      rec.onresult = e=>{
        const text = e.results[0][0].transcript;
        memoBox.value += (memoBox.value? ' ':'')+ text;
        const item=data[idx];
        localStorage.setItem(`memo::${item.src}`, memoBox.value);
      };
    }

    document.getElementById('voiceBtn').onclick = ()=>{
      if(!rec){ alert('음성 인식이 지원되지 않습니다.'); return; }
      try{ rec.start(); }catch(err){ console.error(err); }
    };
  </script>
</body>
</html>
